Namespace(bs=128, centralized=True, class_per_device=2, dataset='mnist', decay_rate=0.995, device=device(type='cuda', index=0), epochs=200, frac=0.3, gpu=0, kernel_num=9, kernel_sizes='3,4,5', local_bs=10, local_ep=5, lr=0.01, manual_seed=42, max_data_per_device=0, max_pool='True', model='softmax', momentum=0, noniid=1, noniidness=20, norm='batch_norm', num_channels=1, num_classes=10, num_filters=32, num_users=100, per_epoch=1.0, seed=1, split='user', stopping_rounds=10, unbalance=2.0, verbose=False)
use random seed: 42
args.noniid= 1 args.class_per_device= 2 args.unbalance= 2.0
/home/zju/anaconda3/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
[5923, 6742, 5958, 6131, 5842, 5421, 5918, 6265, 5851, 5949]
unbalancing
/home/zju/anaconda3/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
[980, 1135, 1032, 1010, 982, 892, 958, 1028, 974, 1009]
unbalancing
train data partition
sum: 59901
mean: 599.01
std: 874.0787892976239
test data partition
sum: 9921
mean: 99.21
std: 144.76638387415775
federated learning...
SoftmaxClassifier(
  (layer_input): Linear(in_features=784, out_features=10, bias=True)
)
33 client:  [6 7]
77 client:  [4 5]
69 client:  [8 9]
13 client:  [6 7]
63 client:  [6 7]
87 client:  [4 5]
72 client:  [4 5]
18 client:  [6 7]
91 client:  [2 3]
48 client:  [6 7]
7 client:  [4 5]
38 client:  [6 7]
92 client:  [4 5]
75 client:  [0 1]
64 client:  [8 9]
58 client:  [6 7]
56 client:  [2 3]
78 client:  [6 7]
9 client:  [8 9]
60 client:  [0 1]
54 client:  [8 9]
42 client:  [4 5]
84 client:  [8 9]
65 client:  [0 1]
41 client:  [2 3]
25 client:  [0 1]
17 client:  [4 5]
70 client:  [0 1]
98 client:  [6 7]
28 client:  [6 7]
Round   0, Average loss 0.186
Round   0, Average global accuracy 31.00
Round   0, Average local accuracy 32.17
70 client:  [0 1]
18 client:  [6 7]
55 client:  [0 1]
79 client:  [8 9]
9 client:  [8 9]
61 client:  [2 3]
16 client:  [2 3]
97 client:  [4 5]
10 client:  [0 1]
19 client:  [8 9]
29 client:  [8 9]
38 client:  [6 7]
45 client:  [0 1]
3 client:  [6 7]
89 client:  [8 9]
56 client:  [2 3]
75 client:  [0 1]
0 client:  [0 1]
7 client:  [4 5]
85 client:  [0 1]
31 client:  [2 3]
5 client:  [0 1]
28 client:  [6 7]
84 client:  [8 9]
30 client:  [0 1]
46 client:  [2 3]
60 client:  [0 1]
59 client:  [8 9]
41 client:  [2 3]
87 client:  [4 5]
Round   1, Average loss 0.110
Round   1, Average global accuracy 55.00
Round   1, Average local accuracy 55.91
29 client:  [8 9]
23 client:  [6 7]
27 client:  [4 5]
84 client:  [8 9]
74 client:  [8 9]
2 client:  [4 5]
98 client:  [6 7]
16 client:  [2 3]
8 client:  [6 7]
82 client:  [4 5]
30 client:  [0 1]
3 client:  [6 7]
83 client:  [6 7]
80 client:  [0 1]
42 client:  [4 5]
17 client:  [4 5]
71 client:  [2 3]
75 client:  [0 1]
35 client:  [0 1]
45 client:  [0 1]
90 client:  [0 1]
10 client:  [0 1]
25 client:  [0 1]
79 client:  [8 9]
12 client:  [4 5]
78 client:  [6 7]
49 client:  [8 9]
19 client:  [8 9]
40 client:  [0 1]
62 client:  [4 5]
Round   2, Average loss 0.108
Round   2, Average global accuracy 57.00
Round   2, Average local accuracy 60.20
83 client:  [6 7]
21 client:  [2 3]
1 client:  [2 3]
69 client:  [8 9]
55 client:  [0 1]
12 client:  [4 5]
89 client:  [8 9]
32 client:  [4 5]
88 client:  [6 7]
26 client:  [2 3]
44 client:  [8 9]
43 client:  [6 7]
41 client:  [2 3]
65 client:  [0 1]
48 client:  [6 7]
93 client:  [6 7]
81 client:  [2 3]
75 client:  [0 1]
92 client:  [4 5]
28 client:  [6 7]
11 client:  [2 3]
52 client:  [4 5]
61 client:  [2 3]
76 client:  [2 3]
17 client:  [4 5]
5 client:  [0 1]
91 client:  [2 3]
66 client:  [2 3]
16 client:  [2 3]
24 client:  [8 9]
Round   3, Average loss 0.100
Round   3, Average global accuracy 64.00
Round   3, Average local accuracy 65.37
80 client:  [0 1]
34 client:  [8 9]
0 client:  [0 1]
93 client:  [6 7]
43 client:  [6 7]
46 client:  [2 3]
96 client:  [2 3]
86 client:  [2 3]
6 client:  [2 3]
23 client:  [6 7]
5 client:  [0 1]
88 client:  [6 7]
54 client:  [8 9]
92 client:  [4 5]
70 client:  [0 1]
41 client:  [2 3]
97 client:  [4 5]
49 client:  [8 9]
61 client:  [2 3]
84 client:  [8 9]
28 client:  [6 7]
16 client:  [2 3]
37 client:  [4 5]
79 client:  [8 9]
66 client:  [2 3]
73 client:  [6 7]
68 client:  [6 7]
59 client:  [8 9]
30 client:  [0 1]
19 client:  [8 9]
Round   4, Average loss 0.087
Round   4, Average global accuracy 70.00
Round   4, Average local accuracy 70.92
16 client:  [2 3]
4 client:  [8 9]
12 client:  [4 5]
69 client:  [8 9]
13 client:  [6 7]
33 client:  [6 7]
31 client:  [2 3]
97 client:  [4 5]
5 client:  [0 1]
10 client:  [0 1]
89 client:  [8 9]
3 client:  [6 7]
79 client:  [8 9]
1 client:  [2 3]
18 client:  [6 7]
32 client:  [4 5]
23 client:  [6 7]
48 client:  [6 7]
99 client:  [8 9]
9 client:  [8 9]
78 client:  [6 7]
37 client:  [4 5]
61 client:  [2 3]
40 client:  [0 1]
71 client:  [2 3]
25 client:  [0 1]
27 client:  [4 5]
67 client:  [4 5]
36 client:  [2 3]
68 client:  [6 7]
Round   5, Average loss 0.071
Round   5, Average global accuracy 79.00
Round   5, Average local accuracy 78.81
95 client:  [0 1]
37 client:  [4 5]
94 client:  [8 9]
17 client:  [4 5]
38 client:  [6 7]
52 client:  [4 5]
99 client:  [8 9]
86 client:  [2 3]
4 client:  [8 9]
81 client:  [2 3]
59 client:  [8 9]
92 client:  [4 5]
89 client:  [8 9]
26 client:  [2 3]
69 client:  [8 9]
63 client:  [6 7]
42 client:  [4 5]
93 client:  [6 7]
49 client:  [8 9]
40 client:  [0 1]
66 client:  [2 3]
44 client:  [8 9]
25 client:  [0 1]
31 client:  [2 3]
60 client:  [0 1]
50 client:  [0 1]
88 client:  [6 7]
58 client:  [6 7]
98 client:  [6 7]
5 client:  [0 1]
Round   6, Average loss 0.095
Round   6, Average global accuracy 79.00
Round   6, Average local accuracy 78.43
94 client:  [8 9]
93 client:  [6 7]
53 client:  [6 7]
95 client:  [0 1]
98 client:  [6 7]
24 client:  [8 9]
25 client:  [0 1]
74 client:  [8 9]
42 client:  [4 5]
39 client:  [8 9]
12 client:  [4 5]
33 client:  [6 7]
63 client:  [6 7]
1 client:  [2 3]
52 client:  [4 5]
23 client:  [6 7]
56 client:  [2 3]
40 client:  [0 1]
51 client:  [2 3]
57 client:  [4 5]
72 client:  [4 5]
61 client:  [2 3]
13 client:  [6 7]
50 client:  [0 1]
73 client:  [6 7]
88 client:  [6 7]
62 client:  [4 5]
65 client:  [0 1]
2 client:  [4 5]
58 client:  [6 7]
Round   7, Average loss 0.080
Round   7, Average global accuracy 78.00
Round   7, Average local accuracy 77.01
49 client:  [8 9]
45 client:  [0 1]
46 client:  [2 3]
18 client:  [6 7]
89 client:  [8 9]
61 client:  [2 3]
14 client:  [8 9]
67 client:  [4 5]
53 client:  [6 7]
39 client:  [8 9]
78 client:  [6 7]
85 client:  [0 1]
36 client:  [2 3]
40 client:  [0 1]
19 client:  [8 9]
0 client:  [0 1]
43 client:  [6 7]
74 client:  [8 9]
25 client:  [0 1]
35 client:  [0 1]
62 client:  [4 5]
22 client:  [4 5]
48 client:  [6 7]
97 client:  [4 5]
93 client:  [6 7]
29 client:  [8 9]
27 client:  [4 5]
20 client:  [0 1]
32 client:  [4 5]
12 client:  [4 5]
Round   8, Average loss 0.075
Round   8, Average global accuracy 81.00
Round   8, Average local accuracy 80.10
52 client:  [4 5]
65 client:  [0 1]
92 client:  [4 5]
10 client:  [0 1]
56 client:  [2 3]
95 client:  [0 1]
19 client:  [8 9]
1 client:  [2 3]
24 client:  [8 9]
51 client:  [2 3]
66 client:  [2 3]
20 client:  [0 1]
7 client:  [4 5]
50 client:  [0 1]
25 client:  [0 1]
81 client:  [2 3]
63 client:  [6 7]
33 client:  [6 7]
60 client:  [0 1]
15 client:  [0 1]
44 client:  [8 9]
16 client:  [2 3]
70 client:  [0 1]
42 client:  [4 5]
77 client:  [4 5]
90 client:  [0 1]
27 client:  [4 5]
45 client:  [0 1]
12 client:  [4 5]
43 client:  [6 7]
Round   9, Average loss 0.081
Round   9, Average global accuracy 77.00
Round   9, Average local accuracy 78.14
30 client:  [0 1]
48 client:  [6 7]
0 client:  [0 1]
31 client:  [2 3]
71 client:  [2 3]
8 client:  [6 7]
2 client:  [4 5]
60 client:  [0 1]
91 client:  [2 3]
77 client:  [4 5]
39 client:  [8 9]
74 client:  [8 9]
59 client:  [8 9]
79 client:  [8 9]
72 client:  [4 5]
22 client:  [4 5]
1 client:  [2 3]
36 client:  [2 3]
65 client:  [0 1]
12 client:  [4 5]
32 client:  [4 5]
28 client:  [6 7]
84 client:  [8 9]
34 client:  [8 9]
4 client:  [8 9]
73 client:  [6 7]
87 client:  [4 5]
